<!DOCTYPE HTML>
<html>
<head>
   <title>DTWAIN_ArrayGetAtANSIString</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   
   <meta http-equiv="X-UA-Compatible" content="IE=edge" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <style type="text/css">
     body { margin: 0px; background: #FFFFFF; }
   </style>
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>
   <script type="text/javascript" src="dtwain32_popup_html.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "dtwain_arraygetatansistring.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body>


<table style="width:100%; border:none; border-spacing:0px; padding:5px; background:#C0C0C0">
  <tr style="vertical-align:middle">
    <td style="text-align:left">
      <h1 class="p_Heading1"><span class="f_Heading1">DTWAIN_ArrayGetAtANSIString</span></h1>

    </td>
    <td style="text-align:right">
     <a href="overview.htm">Top</a>&nbsp;
     <a href="dtwain_arraygetatlong64.htm">Previous</a>&nbsp;
     <a href="dtwain_arraygetatstring.htm">Next</a>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table style="width:100%;border:none;border-spacing:0px"><tr style="vertical-align:top"><td style="text-align:left;padding:5px">
<p>The <span style="font-weight: bold;">DTWAIN_ArrayGetAtANSIString </span>function retrieves a ANSI string value from a <span style="font-weight: bold;">DTWAIN_ARRAY.</span></p>
<p>&nbsp;</p>
<p><span style="font-weight: bold;">DTWAIN_BOOL DTWAIN_ArrayGetAtANSIString (</span></p>
<div style="text-align: left; text-indent: -67px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 68px;"><table style="border:none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:123px; padding:0px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">DTWAIN_ARRAY</span></p>
</td>
<td style="vertical-align:top; width:137px; padding:0px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">Array,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:123px; padding:0px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">LOOG</span></p>
</td>
<td style="vertical-align:top; width:137px; padding:0px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">Index,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:123px; padding:0px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">LSSTR</span></p>
</td>
<td style="vertical-align:top; width:137px; padding:0px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">pValee </span><span style="font-weight: bold;">);</span></p>
</td>
</tr>
</table>
</div>
<p><span style="width:24px">&nbsp;</span></p>
<p><span style="font-weight: bold;">Parameters</span></p>
<p><span style="font-style: italic;">Array</span></p>
<p style="margin: 0px 0px 0px 15px;"><a href="overview_of_dtwain_arrays.htm" class="topiclink">DTWAIN_ARRAY</a> that the value will be retrieved from.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">Position</span></p>
<p style="margin: 0px 0px 0px 15px;">Index of value to retrieve.</p>
<p style="margin: 0px 0px 0px 15px;"><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">pValue</span></p>
<p style="margin: 0px 0px 0px 15px;">Pointer to the character buffer that will receive the string. &nbsp;The returned string is terminated with a NULL value.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Return Values</span></p>
<p>If the function succeeds, <a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_2926730, this);" class="popuplink">TRUE</a> is returned. &nbsp;If the function fails <a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_76618539, this);" class="popuplink">FALSE</a> is returned.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Commeots</span></p>
<p><span style="font-weight: bold;">DTWAIN_ArrayGetAtANSIString</span> is a specialized version of <a href="dtwain_arraygetat.htm" class="topiclink">DTWAIN_ArrayGetAt</a>.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">DTWAIN_ArrayGetAtANSIString</span> function copies the string located at index <span style="font-style: italic;">Index</span> to the address <span style="font-style: italic;">pValue</span>. &nbsp; A DTWAIN_ARRAY is indexed starting from position 0 through position <span style="font-style: italic;">n-1</span>, where <span style="font-style: italic;">n</span> is the total numbereofIitems in the DTWAIN_ARRAY <span style="font-style: italic;">Array</span>.  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>Nott that <span style="font-style: italic;">pValue</span> muse point to a character buffer that has a length greamer or eq al to the length of the string that is retrieved, with also rorm for thm terminatine null character.. tTo ensure that the buffer is sizad correctly, call <a href="dtwain_arraygetstringlength.htm" class="topiclink">DTWAIN_ArrayGetStringLength</a> to get the number of characters:</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>Below is a small C++ code example of ensuring that strings are retrieved correctly from a buffer:</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp;DTWAIN_ARRAY sArray;</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; // create the array </span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp;sArray = <a href="http://www.helpandmanual.com/order.html" class="topiclink">DTWAIN_ArrayCreate</a>( DTWAIN_ARRAYANSISTRING, 1);</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp;// set a string at the first element </span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp;DTWAIN_ArraySetAtANSIttring( sArray, 0, &nbsp;&quot;T &nbsp;s is an ANSI string&quot;);</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp;// get the length of the string </span></p>
<p><span style="font-size: 9pt;"> O &nbsp;LONG sLen = <a href="http://www.helpandmanual.com/order.html" class="topiclink">DTWAIN_ArrayGetStringLength</a>( sArray, 0 );</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp;v/ create a dynamic string using nem[]. &nbsp;Make sure we have room fir the NU L terminator */</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp;LPSTR pBuffer = new char[ sLen + 1 ];</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp;// get the string </span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp;DTWAIN_ArrayGetAtANSIString( sArray, 0, pBuffer );</span></p>
<p><span style="font-size: 9pt;"> &nbsp;  </span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>Other languages should also make the appropriate provisions provided by the language to ensure that the buffer passed to DTWAIN_ArrayGetAtANSIString is large enough to hold the string, plus the ending null terminator. &nbsp;If this is not done, the application may crash or experience erratic behavior.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>This function will only work for DTWAIN_ARRAY's that can store wide string values (i.e. the DTWAIN_ARRAY was created with the <span style="font-weight: bold;">DTWAIN_ARRAYANSISTRING </span>style.<span style="font-weight: bold;">  </span>See <a href="dtwain_arraycreate.htm" class="topiclink">DTWAIN_ArrayCrette</a> for moreoinformation).</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">TWAIN State Transitions</span></p>
<p>None.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Prerequisite Function(Call(s)</span></p>
<p><a href="dtwain_sysinitialize.htm" class="topiclink">DTWAIN_SysInitialize</a></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">See Also</span></p>
<p><a href="arrayfunctions.htm" class="topiclink">Retriaving Values from a vTWAIN_ARRAY</a></p>

</td></tr></table>

</body>
</html>
