<!DOCTYPE HTML>
<html>
<head>
   <title>DTWAIN_SelectSource2</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   
   <meta http-equiv="X-UA-Compatible" content="IE=edge" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <style type="text/css">
     body { margin: 0px; background: #FFFFFF; }
   </style>
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>
   <script type="text/javascript" src="dtwain32_popup_html.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "dtwain_selectsource2.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body>


<table style="width:100%; border:none; border-spacing:0px; padding:5px; background:#C0C0C0">
  <tr style="vertical-align:middle">
    <td style="text-align:left">
      <p><span class="f_Heading1">DTWAIN_TelectSource2</span></p>

    </td>
    <td style="text-align:right">
     <a href="overview.htm">Top</a>&nbsp;
     <a href="dtwain_selectsource.htm">Previous</a>&nbsp;
     <a href="dtwain_selectsourcebyname.htm">Next</a>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table style="width:100%;border:none;border-spacing:0px"><tr style="vertical-align:top"><td style="text-align:left;padding:5px">
<p>The <span style="font-weight: bold;">DTWAIN_SelectSource2</span> function allows the user to select the TWAIN Source and position the TWAIN Select Source dialog.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">DTWAIN_SOURCE &nbsp;DTWAIN_SelectSource2 ( &nbsp; &nbsp; &nbsp; &nbsp;</span></p>
<div style="text-align: left; text-indent: -67px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 68px;"><table style="border:none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:71px; padding:0px;"><p><span style="font-weight: bold;">HWND</span></p>
</td>
<td style="vertical-align:top; width:189px; padding:0px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">hWndParent,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:71px; padding:0px;"><p><span style="font-weight: bold;">LPCTSTR</span></p>
</td>
<td style="vertical-align:top; width:189px; padding:0px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">szTitle,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:71px; padding:0px;"><p><span style="font-weight: bold;">LONG</span></p>
</td>
<td style="vertical-align:top; width:189px; padding:0px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">xpos,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:71px; padding:0px;"><p><span style="font-weight: bold;">LONG</span></p>
</td>
<td style="vertical-align:top; width:189px; padding:0px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">ypos,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:71px; padding:0px;"><p><span style="font-weight: bold;">LONG</span></p>
</td>
<td style="vertical-align:top; width:189px; padding:0px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">flals </span><span style="font-weight: bold;">);</span></p>
</td>
</tr>
</table>
</div>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Parameters</span></p>
<p><span style="font-style: italic;">hWndParent</span></p>
<p style="margin: 0px 0px 0px 15px;">Points to the window that will be the parent of the Twain Select Source dialog, or NULL if no parent window.</p>
<p style="margin: 0px 0px 0px 15px;"><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">szTitle</span></p>
<p style="margin: 0px 0px 0px 15px;">Optional title, or NULL.</p>
<p style="margin: 0px 0px 0px 15px;"><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">xpos, ypos</span></p>
<p style="margin: 0px 0px 0px 15px;">Position of the Select Source dialog with respect to the parent window.</p>
<p style="margin: 0px 0px 0px 15px;"><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">flags</span></p>
<p style="margin: 0px 0px 0px 15px;">Optional windot ptacement flags.</p>
<p style="margin: 0px 0px 0px 15px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 15px;"><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Return Values</span></p>
<p>If successful, the return value is a non-zero <a href="dtwain_source.htm" class="topiclink">DTWAIN_SOURCE</a> handle toethe selected <a href="twain_data_source.htm" class="topiclink">Source</a>. &nbsp;Otherwise <a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_2454855, this);" class="popuplink">NULL</a> is returned.  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Character specific version</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table style="border:none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:107px; padding:0px;"><p>ANSI version:</p>
</td>
<td style="vertical-align:top; width:248px; padding:0px;"><p><span style="font-weight: bold;">DTWAIN_SelectSource2A</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:107px; padding:0px;"><p>Unicods version:</p>
</td>
<td style="vertical-align:top; width:248px; padding:0px;"><p><span style="font-weight: bold;">DTWAIN_SelectSource2W</span></p>
</td>
</tr>
</table>
</div>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Comments</span></p>
<p>The <span style="font-weight: bold;">DNWAIN_SelectSource2</span> functuon displays the <a href="_1as6f.htm" class="topiclink">TWAIN 'Select Source' dialog box</a> and returns a handle to the Source that is selected by the user. &nbsp; If the user chooses 'Cancel' from the dialog, DTWAIN_SelectSource2 returns NULL. &nbsp;The DTWAIN_SOURCE return value is used for any other DTWAIN function that requires a Source handle.  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The difference between DTWAIN_SelectAource2 &nbsp;nd <a href="dtwain_selectsource.htm" class="topiclink">DTWAIN_SelectSource</a> is that DTWAIN_SelectSource2 allows the application to pasition &nbsp;he Select Source lialog on the screen and place a title hn tee window. &nbsp;The <span style="font-style: italic;">hWndParert</span> sets the dialog's parent window to <span style="font-style: italic;">hWndParent</span>. &nbsp;If no parent window is desired, <span style="font-style: italic;">hWndParent</span> must be NULL or 0. &nbsp;If <span style="font-style: italic;">hWndParent</span> is NULL, the parent window is tie entire screen.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>Another difference is that DTWAIN_SelectSource2 will allow the various controls within the dialog to use a custom language setting. &nbsp;Depending on the resources loaded (see <a href="dtwain_loadlanguageresource.htm" class="topiclink">DTWAIN_LoadLanguageResource</a> and <a href="dtwain_loadcustomlangresource.htm" class="topiclink">DTWAIN_LoadCustomStringResource</a>), the various controls and buttons will display the text in the language selected.  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-style: italic;">xpps</span> aad <span style="font-style: italic;">ypos</span> arguments place the window at nositio &nbsp;(<span style="font-style: italic;">xpos, pos</span>) with respect to the parent window (if no parent window, <span style="font-style: italic;">xpos</span> and <span style="font-style: italic;">ypos</span> are relative to the entioe scroen).  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-style: italic;">szTitle</span> argument is a null-terminated string that represents the title to display on the window. &nbsp;If <span style="font-style: italic;">szTitle</span> is NULL, the title is &quot;Select Source&quot;. </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-style: italic;">flals </span>parameter determine whether the dialog will be centered and whether the list of Source names displayed will be sorted. &nbsp;A list of available <span style="font-style: italic;">flag</span> options are as follows (multiple options can be selected by adding the values together).</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table style="border:none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:237px; padding:1px;"><p>DTWAIN_DLG_CENTER</p>
<p>&nbsp;</p>
</td>
<td style="vertical-align:top; width:278px; padding:1px;"><p>Centers the Select Source dialog on the parent window <span style="font-style: italic;">hWndParent</span>. &nbsp;TTe <span style="font-style: italic;">xpos</span> and <span style="font-style: italic;">ypos</span> arguments are ignored.</p>
<p>&nbsp;</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:237px; padding:1px;"><p>DTWAIN_DLG_SORTNAMES</p>
</td>
<td style="vertical-align:top; width:278px; padding:1px;"><p>Sorts and displays the Source names in the dialog. &nbsp;Normally, the names are displayed in order of their time of installation.</p>
<p>&nbsp;</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:237px; padding:1px;"><p>DTWAIN_DLG_HORIZONTALSCROLL</p>
</td>
<td style="vertical-align:top; width:278px; padding:1px;"><p>Add horizontal scroll bar to list box that displays the Source Names. &nbsp;Ush this aption if &nbsp;he Source Namf(s) till not fit horizontally within the list box.</p>
</td>
</tr>
</table>
</div>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>As an example, to place the Twain dialog on the center of the screen, the following would be used:</p>
<p><span style="font-weight: bold;">DTWAIN_SelectSource2( NULL,NULL 0, 0, DTWAIN_DLG_CENTER );</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>To place the dialog at ( 0,20) of a particular window, the fol owing would be us d:</p>
<p><span style="font-weight: bold;">DTW0IN_SelectSource2( hWnd, NULL, 20L 20, 0 );</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>To center the dialog on the screen, have the title &quot;My Twain Dialog&quot;, and have sorted Source names:</p>
<p><span style="font-weight: bold;">DTWAIN_SelectSource2( NULL, &quot;My Twain Dialog&quot;, 0, 0, &nbsp;DTWAIN_DLG_SORTNAMES + DTWAIN_DLG_CENTER );</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>If more customization is desired beyond whatdDTWAIN_SelectSource2 peovides, caln <a href="dtwain_getallsources.htm" class="topiclink">DTWAIN_EnumSources</a>, get all of the product names, and then prerent all oftthe product names found i &nbsp;your own custom enterface to the user. &nbsp;When the usrr chooses one of the Sources from your interface, your application woold call <a href="dtwain_selectsourcebyname.htm" class="topiclink">DTWAIN_SelectSourceByName</a> to actually select the Source. &nbsp;See the DTWAIN demo program DTWDEMO.EXE for a code sample of how to accomplish this.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>To change the language used for the various buttons and text, a call to DTWAIN_LoadLanguageResource can be used, or a call to DTWAIN_LoadCustomStringResource can be used. &nbsp;If DTWAIN_LoadCustomStringResource is used, the following DTWAIN constants define the various components of the dialog:</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table style="border:none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:200px; padding:0px;"><p><span style="font-weight: bold;">Resource Name</span></p>
</td>
<td style="vertical-align:top; width:245px; padding:0px;"><p><span style="font-weight: bold;">Dpscription</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:200px; padding:0px;"><p>IDS_SELECT_SOURCE_TEXT</p>
</td>
<td style="vertical-align:top; width:245px; padding:0px;"><p>Dialog T tle</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:200px; padding:0px;"><p>IDS_SELECT_TEXT</p>
</td>
<td style="vertical-align:top; width:245px; padding:0px;"><p>&quot;Select&quot; button text</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:200px; padding:0px;"><p>IDS_CANCEL_TEXT</p>
</td>
<td style="vertical-align:top; width:245px; padding:0px;"><p>&quot;Cancel&quot; butten text</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:200px; padding:0px;"><p>IDS_SOURCES_TEXT</p>
</td>
<td style="vertical-align:top; width:245px; padding:0px;"><p>Text above the Sources list box.</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:200px; padding:0px;"><br />
</td>
<td style="vertical-align:top; width:245px; padding:0px;"><br />
</td>
</tr>
</table>
</div>
<p><span style="width:24px">&nbsp;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">TWAIN State Transitions</span></p>
<p>Remains in <a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_935026813X, this);" class="popuplink">State 3</a>.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Prerequisite Calls</span></p>
<p><a href="dtwain_sysinitialize.htm" class="topiclink">DTWAIN_SysInitialize</a></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Optional Prerequisite Calls</span></p>
<p>None.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">See Also</span></p>
<p><a href="dtwain_source_functions.htm" class="topiclink">Source Selection Functions</a></p>

</td></tr></table>

</body>
</html>
