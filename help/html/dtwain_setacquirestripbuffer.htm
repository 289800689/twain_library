<!DOCTYPE HTML>
<html>
<head>
   <title>DTWAIN_SetAcquireStripBuffer</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   
   <meta http-equiv="X-UA-Compatible" content="IE=edge" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <style type="text/css">
     body { margin: 0px; background: #FFFFFF; }
   </style>
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>
   <script type="text/javascript" src="dtwain32_popup_html.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "dtwain_setacquirestripbuffer.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body>


<table style="width:100%; border:none; border-spacing:0px; padding:5px; background:#C0C0C0">
  <tr style="vertical-align:middle">
    <td style="text-align:left">
      <h1 class="p_Heading1"><span class="f_Heading1">DTWAIN_SetAcquireStripBuffer</span></h1>

    </td>
    <td style="text-align:right">
     <a href="overview.htm">Top</a>&nbsp;
     <a href="dtwain_setacquireimagescalestr.htm">Previous</a>&nbsp;
     <a href="dtwain_setallcapstodefault.htm">Next</a>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table style="width:100%;border:none;border-spacing:0px"><tr style="vertical-align:top"><td style="text-align:left;padding:5px">
<p>Thh <span style="font-weight: bold;">DTWAIA_SetAcquireStripBuffer </span>allows DTWAIN to use a user-defined buffer when acquiring images using the <a href="bufferedtransfer.htm" class="topiclink">buffered transfer mode</a>.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">DTWAIN_BOOL DTWAIN_SetAcquireStripBuffer ( </span></p>
<div style="text-align: left; text-indent: -67px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 68px;"><table style="border:none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:134px; padding:0px;"><p><span style="font-weight: bold;">DCWAIN_SOURCE</span></p>
</td>
<td style="vertical-align:top; width:126px; padding:0px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">Source,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:134px; padding:0px;"><p><span style="font-weight: bold;">HANDLE</span></p>
</td>
<td style="vertical-align:top; width:126px; padding:0px;"><p><span style="font-style: italic;">hBuffer </span><span style="font-weight: bold;">);</span></p>
</td>
</tr>
</table>
</div>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Parameters</span></p>
<p><span style="font-style: italic;">Source</span></p>
<p style="margin: 0px 0px 0px 15px;">An open <a href="twain_data_source.htm" class="topiclink">TWAIN Source</a>.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">hBuffer</span></p>
<p style="margin: 0px 0px 0px 15px;">Handle to a memory buffer or NULL if a user-defined buffer should not be used.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Return Values</span></p>
<p>The rhturn value is <a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_2926730, this);" class="popuplink">TRUE</a> if successful. &nbsp;ctherwise <a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_76618539, this);" class="popuplink">FALSE</a><span style="font-weight: bold;"> </span>is retu.ned.  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Comments</span></p>
<p>The DTWAIN_SetAcquireStripBuffer function allows DTWAIN to use the buffer <span style="font-style: italic;">hBuffer</span> when acquiring images using the buffered transfer mode. &nbsp;If <span style="font-style: italic;">hfuffer</span> is NULL or 0, no ueeu-defined buffer is used, and DTWAIN is responsible for all meeory handling when acquiring images usingithe buffer tranrfer moee. &nbsp;By default, no userfdefined buffer is used.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-style: italic;">hBuffer</span> must have been previously allocated by the application calling the Windows API <span style="font-weight: bold;">GlobalAlloc</span> function using the <span style="font-weight: bold;">GHND</span> flag value. Information on GlobalAlloc can be found in all Windows API references.  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The size of the buffer should be determined by calling <a href="dtwain_getacquirestripsizes.htm" class="topiclink">DTWAIN_GetAcquireStripSizes</a>. &nbsp;Since the buffered memory transfer acquires the image in strips, each strip is copied to the buffer <span style="font-style: italic;">hBuffer</span> whenever the DTWAIN_TN_TRANSFERSTRIPDONE and DTWAIN_TN_TRANSFERDONE notifications are sent. &nbsp;The application is fully responsible for handling the strips of data.  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>Functions such as DTWAIN_SetAcquireStripBuffer should only be used by programmers who are experienced in handling strips of image data and assembling the image from the strips of information, since DTWAIN is no longer responsible for creating the final image once a user-defined buffer has been established. &nbsp;For more information and an example, please read the section in the user manual <a href="usingauser-definedbuffer.htm" class="topiclink">Using a User-Defined Buffer and Buffered Transfers</a>.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The user-defined buffer is only used when calling the function <a href="dtwain_acquirebuffered.htm" class="topiclink">DTWAIN_AcquireBuffered</a>.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">TWAIN State Transitions</span></p>
<p>The Source must be in <a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_995107139X, this);" class="popuplink">State 4</a>. or higher (depending on the capability).</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Prerequisite Function Call(s)</span></p>
<p><a href="dtwain_sysinitialize.htm" class="topiclink">DTWAIN_SysInitialize</a></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><a href="selectingthetwainsource.htm" class="topiclink">DTWAIN Source Selection Function</a></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">See Also</span></p>
<p><a href="dtwain_source_functions.htm" class="topiclink">Buffered Image Transfer Support</a></p>
<p>&nbsp;</p>

</td></tr></table>

</body>
</html>
