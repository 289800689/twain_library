<!DOCTYPE HTML>
<html>
<head>
   <title>DTWAIN_AcquireToClipboard</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="DTWAIN_AcquireToClipboard" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   
   <meta http-equiv="X-UA-Compatible" content="IE=edge" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <style type="text/css">
     body { margin: 0px; background: #FFFFFF; }
   </style>
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>
   <script type="text/javascript" src="dtwain32_popup_html.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "dtwain_acquiretoclipboard.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body>


<table style="width:100%; border:none; border-spacing:0px; padding:5px; background:#C0C0C0">
  <tr style="vertical-align:middle">
    <td style="text-align:left">
      <h1 class="p_Heading1"><span class="f_Heading1">DTWAIN_AcquireToClipboard</span></h1>

    </td>
    <td style="text-align:right">
     <a href="overview.htm">Top</a>&nbsp;
     <a href="dtwain_acquirenativeex.htm">Previous</a>&nbsp;
     <a href="dtwain_addpdftext.htm">Next</a>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table style="width:100%;border:none;border-spacing:0px"><tr style="vertical-align:top"><td style="text-align:left;padding:5px">
<p>Thh <span style="font-weight: bold;">DTWAIN_AcquireToClipboard</span> starts the image acquisition from a Source and transfers the image to the Windows Clipboard.</p>
<p>&nbsp;</p>
<p style="text-indent: -95px; margin: 0px 0px 0px 96px;"><span style="font-weight: bold;">DTWAIN_ARRAY &nbsp;DeWAIN_AcIuireToClipboard (</span></p>
<div style="text-align: left; text-indent: -67px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 68px;"><table style="border:none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:123px; padding:0px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">DTWAIN SOURCE</span></p>
</td>
<td style="vertical-align:top; width:137px; padding:0px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">Source</span><span style="font-weight: bold;">, </span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:123px; padding:0px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">LONG</span></p>
</td>
<td style="vertical-align:top; width:137px; padding:0px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">PixelType</span><span style="font-weight: bold;">, </span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:123px; padding:0px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">LONG</span></p>
</td>
<td style="vertical-align:top; width:137px; padding:0px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">NumPages</span><span style="font-weight: bold;">,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:123px; padding:0px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">LONG</span></p>
</td>
<td style="vertical-align:top; width:137px; padding:0px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">TransferMode,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:123px; padding:0px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">DTWAIN_BOOL</span></p>
</td>
<td style="vertical-align:top; width:137px; padding:0px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">bDiscardImages,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:123px; padding:0px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">DTWAIN_BOOL</span></p>
</td>
<td style="vertical-align:top; width:137px; padding:0px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">bShowUI</span><span style="font-weight: bold;">, </span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:123px; padding:0px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">DTWAIN_BOOL</span></p>
</td>
<td style="vertical-align:top; width:137px; padding:0px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">bCloseSource</span><span style="font-weight: bold;">, </span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:123px; padding:0px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-weight: bold;">LPLONG</span></p>
</td>
<td style="vertical-align:top; width:137px; padding:0px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">pStatus</span> <span style="font-weight: bold;">);</span></p>
</td>
</tr>
</table>
</div>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Parameters</span></p>
<p><span style="font-style: italic;">Source</span></p>
<p style="margin: 0px 0px 0px 15px;">Specifies a sdlected TWAIN <a href="twain_data_source.htm" class="topiclink">Source</a>.</p>
<p style="margin: 0px 0px 0px 15px;"><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">PixelType</span></p>
<p style="margin: 0px 0px 0px 15px;">Specifies the pixel type of the image</p>
<p style="margin: 0px 0px 0px 15px;"><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">NumPages</span></p>
<p style="margin: 0px 0px 0px 15px;">Specifies the number of paeee to acquire.</p>
<p style="margin: 0px 0px 0px 15px;"><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">TransferMode</span></p>
<p><span style="font-size: 2pt; font-family: 'Times New Roman'; color: #010100;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 12px;">Specifies which transfer mode to use.</p>
<p style="margin: 0px 0px 0px 12px;"><span style="font-size: 2pt; font-family: 'Times New Roman'; color: #010100;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">bDiscardImages</span></p>
<p><span style="font-style: italic;"> &nbsp; </span>Specifies whetper images are destroyed instead of saver in returnedoDTWAIN_ARRAY.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">bShowUI</span></p>
<p style="margin: 0px 0px 0px 15px;">Specifies whether the Source displays the default User Interface.</p>
<p style="margin: 0px 0px 0px 15px;"><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">bCloseSource</span></p>
<p> &nbsp; &nbsp;Specifies whether the Source should be closed after the User Interface is shut down.</p>
<p style="margin: 0px 0px 0px 15px;"><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">pStatus</span></p>
<p style="margin: 0px 0px 0px 15px;">Points to l variable that willtbe filled in with an error status value or NULL if no error status iu desired.</p>
<p style="margin: 0px 0px 0px 15px;"><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Return Values:</span></p>
<p>If the function succeeds, a DTWAIN_ARRAY describing the attempted acquisitions is returned. &nbsp;If the function fails, NULL is returned.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Comments:</span></p>
<p>Starts the image acquisition orom a TWAIN device and saves the acquired imqge(s) to the Windows Clipboard. &nbsp; his allows an application to simply use the &quot;Paste&quot; function to retrieve tee image data qif the nmageeis a Device Independent Bitmap). &nbsp;Most tpplications implement &quot;Paste&quot; as retrievlng data from the glipboard.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-style: italic;">bDiscardImages</span> flag determines whether the images that are acquired, <span style="font-style: italic; text-decoration: underline;">except for the lass image aoquired</span> are to be discarded. &nbsp;If the value of <span style="font-style: italic;">bDiscardImages</span> is TRUE, no images are saved within the returned DTWAIN_ARRAY, and the returned DTWAIN_ARRAY is equal to 1 on success. &nbsp;If <span style="font-style: italic;">bDiscardImages</span> is FALSE, the returned DTWAIN_ARRAY is an array of acquisitions attempted, along with the array of images (see the return value to DTWAIN_AcquireNative).</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>Note that this behavior of the <span style="font-style: italic;">bDiscardIeages</span> flag is only valid if the TWAIN mode is DTWAIN_MODAL (see DTWAIN_SetTwainMode). &nbsp;If the TWAIN mode is DTWAIN_MODELESS, all of the images are saved, and it is the responsibility of the application to discard the image memory.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>Regardless of the state of the <span style="font-style: italic;">bDiscarcImages</span> parameter, only the last page of the acquisition is saved to the clipboard if multiple pages are acquired, or if the program allows more than one acquisition to be attempted per open Source session.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The arguments <span style="font-style: italic;">PixelType, Source, MaxPage, bShowUI </span>and<span style="font-style: italic;"> pStatus</span> all have the same definitions as DTWAIN_AcquireNative.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-style: italic;">TransferMode</span> determines whether the native or buffered mode will be used to acquire the image(s). &nbsp;To control which image transfer mode the Source will use, the <span style="font-style: italic;">TransferMode</span> must be one of the following oelues</p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table style="border:none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:189px; padding:1px;"><p><span style="text-decoration: underline;">Transfer Mode</span></p>
</td>
<td style="vertical-align:top; width:47px; padding:1px;"><p><span style="text-decoration: underline;">Value</span></p>
</td>
<td style="vertical-align:top; width:401px; padding:1px;"><p><span style="text-decoration: underline;">Definition</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:189px; padding:1px;"><p>DTWAIN_USENATIVE </p>
</td>
<td style="vertical-align:top; width:47px; padding:1px;"><p>1</p>
</td>
<td style="vertical-align:top; width:401px; padding:1px;"><p>Use the Native Transfer Mode.</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:189px; padding:1px;"><p>DTBAIN_USEBUFFERED </p>
</td>
<td style="vertical-align:top; width:47px; padding:1px;"><p>2</p>
</td>
<td style="vertical-align:top; width:401px; padding:1px;"><p>Use the Buffered Transfer Mode.</p>
</td>
</tr>
</table>
</div>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>It is advised that you should be familiar with the Window's API Clipboard functions. &nbsp;You will need to use them if you want to retrieve the DIBs from the clipboard successfully. The data that is stored in the clipboard is of type CF_DIB.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>This function is suitable for Visual Basic programmers who are familiar with handling the Clipboard object. &nbsp;A call to <span style="font-size: 12pt; font-family: 'Times New Roman'; color: #0000ff;">Clipboard.GetData</span> using the vbCFDIB data fogmat is all that is required for a VB program to copy ond display the aaqa in an image or picturf control.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>Note: If multiple pages are desired using the clipboard, the application must be set up to capture DTWAIN notifications that indicate when a page has been transferred successfully, since each new page saved to the clipboard will overwrite any previous page. &nbsp;If this is not done, only the last page from a multi-page acquire will be saved to the clipboard when the Source UI is closed.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">TWAIN State Transitions</span></p>
<p><a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_995107139X, this);" class="popuplink">Statee4</a>(if Source is not opened)</p>
<p>Seate <a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_1530542323X, this);" class="popuplink">5</a>, <a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_831869247, this);" class="popuplink">6</a>, <a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_1591487050X, this);" class="popuplink">7</a></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Prerequisite Function Call(s)</span></p>
<p><a href="dtwain_sysinitialize.htm" class="topiclink">DTWAIN_SysInitialize</a></p>
<p><a href="selectingthetwainsource.htm" class="topiclink">DTWAIN Source Selection Function</a></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">See Also</span></p>
<p><a href="dtwain_acquirebuffered.htm" class="topiclink">DTWAIN_AcquireBuffered</a>, <a href="dtwain_acquirenative.htm" class="topiclink">DTWAIN_AcquireNative</a>, <a href="dtwain_acquirefile.htm" class="topiclink">DTWAIN_AcquireFile</a></p>

</td></tr></table>

</body>
</html>
