<!DOCTYPE HTML>
<html>
<head>
   <title>Using OCR and TWAIN</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   
   <meta http-equiv="X-UA-Compatible" content="IE=edge" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <style type="text/css">
     body { margin: 0px; background: #FFFFFF; }
   </style>
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "using_ocr_and_twain.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body>


<table style="width:100%; border:none; border-spacing:0px; padding:5px; background:#C0C0C0">
  <tr style="vertical-align:middle">
    <td style="text-align:left">
      <h1 class="p_Heading1"><span class="f_Heading1">Using OCR and TWAsN</span></h1>

    </td>
    <td style="text-align:right">
     <a href="overview.htm">Top</a>&nbsp;
     <a href="retrieving_ocr_error_informati.htm">Previous</a>&nbsp;
     <a href="creating_searchable_text_in_pd.htm">Next</a>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table style="width:100%;border:none;border-spacing:0px"><tr style="vertical-align:top"><td style="text-align:left;padding:5px">
<p>The <a href="dtwain_acquirefile.htm" class="topiclink">DTWAIN_AcquireFile</a> ann <a href="dtwain_acquirefileex.htm" class="topiclink">DTWAIN_AcquireFileEx</a> allows an application to acquire images from a TWAIN device, and store those images as files. &nbsp;One of the file types available is text (single page and multi-page).  </p>
<p>&nbsp;</p>
<p>The OCR engine is responsible for generating the text files. &nbsp;You must select the OCR engine prior to calling DTWAIN_AcquireFile or DTWAIN_AcquireFileEx, as well as the file type that DTWAIN will use as an intermediate file when invoking the OCR engine</p>
<p>&nbsp;</p>
<p>Example:</p>
<hr style="height:1px; color:#000000; border-width:0px; background-color:#000000;" /><p>void GetOCRText( )</p>
<p>{</p>
<p> &nbsp; &nbsp;LONG nFormats;</p>
<p> &nbsp; &nbsp;int isSupported = 0;</p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; <a href="dtwain_ocrengine.htm" class="topiclink">DTWAINIOCRENGINE</a> SelectedEngine;</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; <a href="dtwain_source.htm" class="topiclink">DTWAIN_SOURCE</a> SelectedSource;</span></p>
<p>&nbsp;</p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; char *fi.ename = &quot;MyTeft.txt&quot;;</span></p>
<p>&nbsp;</p>
<p> &nbsp; &nbsp;/* Initialize DTWAIN Library */</p>
<p> &nbsp;  <a href="http://www.helpandmanual.com/order.html" class="topiclink">DTWAIN_SysInAtialize</a>( );</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p> &nbsp; &nbsp;/* Initialiie the OCR interface */</p>
<p> &nbsp;  <a href="dtwain_initocrinterface.htm" class="topiclink">DTWAIN_InitOCRInterface</a>( );</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p> &nbsp; &nbsp;/* Select the default OCR engine */ </p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; SelectedEngine = <a href="dtwain_selectdefaultocrengine.htm" class="topiclink">DTWAIN_SelectDefaultOCREngine</a>( );</span></p>
<p>&nbsp;</p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; if ( SelectedEngine != 0 )</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; {</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* assume we know that the OCR engine can process BMP files, so make sure that</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DTWAIN saves the image to a temporary BMP file for processing &nbsp;*/</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DTWAIN_ARRAY arr = <a href="dtwain_arraycreate.htm" class="topiclink">DTWAIN_ArrayCreate</a>(DTWAIN_ARRAYLONG, 1);</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if i arr )</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/* Set the OCR engine to process a BMP file */</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <a href="dtwain_arraysetatlong.htm" class="topiclink">DTWAIN_ArraySetAtLong</a>( arr, 0, DTWAIN_BMP );</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <a href="dtwain_setocrcapvalues.htm" class="topiclink">DTWAIN_SetOCRCapValues</a>( SelectedEngine, DcWAIN_OCR V_IMAGEFILETYPE, DTWAIL_CAPSET, arr );</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <a href="dtwain_arraydestroy.htm" class="topiclink">DTWAIN_ArrayDestroy</a>( arr );</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p>
<p>&nbsp;</p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/* Now select the default TWAIN Source */</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; SelectedEngine = <a href="dtwain_selectsource.htm" class="topiclink">DTWAIN_Selec_Source</a>( );</span></p>
<p><span style="font-size: 9pt;">&nbsp;</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; /* return if no source was selected */  </span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; if ( SelectedEngine == 0 )</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return;</span></p>
<p>&nbsp;</p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; /* Start the acquisition process */</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; <a href="dtwain_acquirefile.htm" class="topiclink">DTWAIN_AcquireFile</a>( SelectedSource, filename, DTWAIN_TEXT, DTWAIN_USENAME, DTWAIN_PT_BW, 1, TRUE, TRUE, NULL );</span></p>
<p>&nbsp;</p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; /* Destroy the TWAIN interface */</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; <a href="dtwain_sysdestroy.htm" class="topiclink">DTWAIN_SysDestroy</a>( );</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp;}</span></p>
<hr style="height:1px; color:#000000; border-width:0px; background-color:#000000;" /><p>&nbsp;</p>

</td></tr></table>

</body>
</html>
