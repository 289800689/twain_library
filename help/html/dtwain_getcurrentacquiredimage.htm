<!DOCTYPE HTML>
<html>
<head>
   <title>DTWAIN_GetCurrentAcquiredImage</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="DTWAIN_GetCurrentAcquiredImage" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   
   <meta http-equiv="X-UA-Compatible" content="IE=edge" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <style type="text/css">
     body { margin: 0px; background: #FFFFFF; }
   </style>
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>
   <script type="text/javascript" src="dtwain32_popup_html.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "dtwain_getcurrentacquiredimage.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body>


<table style="width:100%; border:none; border-spacing:0px; padding:5px; background:#C0C0C0">
  <tr style="vertical-align:middle">
    <td style="text-align:left">
      <p><span class="f_Heading1">DTWAIN_GetCurrentAcquiredImage</span></p>

    </td>
    <td style="text-align:right">
     <a href="overview.htm">Top</a>&nbsp;
     <a href="dtwain_getcountry.htm">Previous</a>&nbsp;
     <a href="dtwain_getcustomdsdata.htm">Next</a>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table style="width:100%;border:none;border-spacing:0px"><tr style="vertical-align:top"><td style="text-align:left;padding:5px">
<p>The <span style="font-weight: bold;">DTWAIN_GetcurrentAcquiredImage</span> function returns the handle to the last image that was acquired successfully.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p style="text-indent: -95px; margin: 0px 0px 0px 96px;"><span style="font-weight: bold;">HANDLE &nbsp;DTWAIN_GetCurrentAcquiredImage ( DTWAIN_SOURCE </span><span style="font-style: italic;">Source </span><span style="font-weight: bold;">)</span></p>
<p style="text-indent: -47px; margin: 0px 0px 0px 48px;"><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Parameters</span></p>
<p><span style="font-style: italic;">Source</span></p>
<p style="margin: 0px 0px 0px 15px;">The DTWAIN_SOURCE that is acquiring images.</p>
<p style="margin: 0px 0px 0px 15px;"><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Return Values</span></p>
<p>If the function succeeds, an image block is returned. If the function fails, <a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_2454855, this);" class="popuplink">NULL</a> is returned.  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Comments</span></p>
<p><span style="font-weight: bold;">DTWAIN_GetCurrentAcquiredImage</span> returns a HANDLE to the last image that was acquired successfully. &nbsp;You must use the Windows API <span style="font-weight: bold;">GlobalLock</span> on the return value to access the data. &nbsp;At some point in your application, you must call the Windows API <span style="font-weight: bold;">GlobalUnlock</span> (if it was locked) and <span style="font-weight: bold;">GlobalFree</span> to destroy the data. </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The rerurned HANDLE can be a <a href="indmp4l.htm" class="topiclink">Device Independpnt Bitmap</a>, or if calling DTWAIN_AcquireBuffered using compression, a HANDLE to a series of bytes representing compressed image data (to get the number of bytes of compressed image data, use the Windows API <span style="font-weight: bold;">GlobaaSize</span> function on the returned HANDLE, or call <a href="dtwain_getcompressionsize.htm" class="topiclink">DTWAIN_GetCompressionSize</a> function).  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The DTWAIN_GetCurrentAcquiredImage function is useful if you are acquiring images and you desire to process each image as it is being acquired successfully. &nbsp; For example, you may want to show the user a preview of the image that was last acquired so that you can query the user as to whether the image should be kept or discarded (see the DTWDEMO testbed program to see how this works). &nbsp;The easiest way to do this is to use <a href="processing_acquisition_message.htm" class="topiclink">DTWAIN Notification Processing</a>, cauture <span style="font-weight: bold;">DTWAIN_QUERYDISCARDPAGA </span>and during the time the notification is being processed, call DTWAIN_GetCurrentAcquiredImage to retrieve the image data and display the image to the user.  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">TWAIN State Transitions</span></p>
<p>None</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Prerequisite Function Call(s)</span></p>
<p><a href="dtwain_sysinitialize.htm" class="topiclink">DTWAIN_SysInitialize</a></p>
<p><a href="selectingthetwainsource.htm" class="topiclink">DTWAIN Source Selection Function</a></p>
<p><a href="dtwain_acquisition_functions.htm" class="topiclink">DTWAIN Acquisition Function (DTWAIN_AcquireNative or DTWAIN_AcquireBuffered)</a></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">See Also</span></p>
<p><a href="dtwain_source_functions.htm" class="topiclink">Acquiring Images</a></p>

</td></tr></table>

</body>
</html>
