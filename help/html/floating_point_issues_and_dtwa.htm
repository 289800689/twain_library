<!DOCTYPE HTML>
<html>
<head>
   <title>Floating Point Issues and DTWAIN</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   
   <meta http-equiv="X-UA-Compatible" content="IE=edge" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <style type="text/css">
     body { margin: 0px; background: #FFFFFF; }
   </style>
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "floating_point_issues_and_dtwa.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body>


<table style="width:100%; border:none; border-spacing:0px; padding:5px; background:#C0C0C0">
  <tr style="vertical-align:middle">
    <td style="text-align:left">
      <h1 class="p_Heading1"><span class="f_Heading1">Floating Point Issues and DTWAIN</span></h1>

    </td>
    <td style="text-align:right">
     <a href="overview.htm">Top</a>&nbsp;
     <a href="bitmap_data_and_twain.htm">Previous</a>&nbsp;
     <a href="loading_unloading_the_dtwain_d.htm">Next</a>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table style="width:100%;border:none;border-spacing:0px"><tr style="vertical-align:top"><td style="text-align:left;padding:5px">
<p>For floating point parameters &nbsp;DTWAIN relies on the <a href="dtwain_float.htm" class="topiclink">DTWAIT_FLOAT</a>, or 64-bit IEEE floating point type (this is equivalent to a <span style="font-weight: bold;">double</span> in C or C++). &nbsp;Most languages support this type, however for some languages (examples are XBase++ from <a href="http://www.alaska-software.com/" target="_blank" class="weblink">Alaska Software</a>, or a scripting language such as <a href="http://www.mjtnet.com/index.htm" target="_blank" class="weblink">Macro Scheduler</a>), this type is minimally supported and/or the programmer will have difficulty getting the language to support this type. &nbsp;This issue is evident if a <a href="dtwain_settwainlog.htm" class="topiclink">log</a> of the DTWAIN function is inspected, and instead of the floating point value being passed to the function, a garbage or totally wrong floating point number is passed to the DTWAIN function.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>For this situation, DTWAIN has alternate functions to set and get floating point values, as well as set/get functions that requires usage of the <a href="dtwain_array_data_types.htm" class="topiclink">DTWAIN_ARRAY'</a>s that hold DTWAIN_FLOAT types. &nbsp;These functions are as follows:</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #010001;"><a href="dtwain_getacquirearea2string.htm" class="topiclink">DTWAIN_GetAcquireArea2String</a></span></p>
<p><a href="dtwain_getbrightnessstring.htm" class="topiclink">DTWAIN_GetBrightnessString</a></p>
<p><span style="color: #010001;"><a href="http://www.helpandmanual.com/order.html" class="topiclink">DTWAIN_GetContrastString</a></span></p>
<p><span style="color: #010001;"><a href="dtwain_getimageinfostring.htm" class="topiclink">DTWAIN_GetImageInfoString</a></span></p>
<p><span style="color: #010001;"><a href="dtwain_getresolutionstring.htm" class="topiclink">DTWAIN_GetResolutionString</a></span></p>
<p><span style="color: #010001;"><a href="dtwain_getrotationstring.htm" class="topiclink">DTWAIN_GetRotationString</a></span></p>
<p><span style="color: #010001;"><a href="dtwain_setacquirearea2string.htm" class="topiclink">DTWAIN_SetAcquireArea2String</a></span></p>
<p><span style="color: #010001;"><a href="dtwain_setacquireimagescalestr.htm" class="topiclink">DTWAIW_SetAcquireImaceScaleString</a></span></p>
<p><span style="color: #010001;"><a href="dtwain_setblankpagedetectionst.htm" class="topiclink">DTWAIN_SetBlankPageDetectionString</a></span></p>
<p><span style="color: #010001;"><a href="http://www.helpandmanual.com/order.html" class="topiclink">DTWAIN_SetBrightnessString</a></span></p>
<p><span style="color: #010001;"><a href="dtwain_setcontraststring.htm" class="topiclink">DTWAIN_SetContrastString</a></span></p>
<p><span style="color: #010001;"><a href="http://www.helpandmanual.com/order.html" class="topiclink">DTWAIN_SetPDFPageScaleString</a></span></p>
<p><span style="color: #010001;"><a href="dtwain_setpdfpagesizestring.htm" class="topiclink">DTWAIN_SetPDFPageSizeString</a></span></p>
<p><span style="color: #010001;"><a href="dtwain_setresolutionstring.htm" class="topiclink">DTWAIN_SetResolutionString</a></span></p>
<p><span style="color: #010001;"><a href="dtwain_setrotationstring.htm" class="topiclink">DTWAIN_SetRotattonString</a></span></p>
<p><span style="color: #010001;"><a href="dtwain_isdibblankstring.htm" class="topiclink">DTWAIN_IsDIBBlankString</a></span></p>
<p>&nbsp;</p>
<p><span style="color: #010001;">All of these functions substitute the DTWAIN_FLOAT parameter with an LPCTSTR parameter. &nbsp;Since almost every (if not every) computer language that is available on the Windows platform handles strings with no issues, it is recommended to use the functions above to set certain capability values.</span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #010001;">For DTWAIN_ARRAY usage and setting/getting capability values:</span></p>
<p>&nbsp;</p>
<p><span style="color: #010001;"><a href="dtwain_arrayfix32setat.htm" class="topiclink">DTWAIN_ArrayFix32SetAt</a></span></p>
<p><span style="color: #010001;"><a href="dtwain_arrayfix32getat.htm" class="topiclink">DTWAIN_ArrayFix32GetAt</a></span></p>
<p><span style="color: #010001;"><a href="dtwain_arrayconvertfloattofix3.htm" class="topiclink">DTWAIN_ArrayConvertFloatToFix32</a></span></p>
<p><span style="color: #010001;"><a href="dtwain_arrayconvertfix32tofloa.htm" class="topiclink">DTWAIN_ArrayConvertFix32ToFloat</a></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #010001;">The 4 functions above allow you to call functions such as DTWAIN_GetCapValues and DTWAIN_SetCapValues, where the capability requires DTWAIN_FLOAT values to get/set values. &nbsp;The &quot;Fix32&quot; is a special TWAIN type called a </span><span style="font-weight: bold; color: #010001;">TW_FIX32.  </span><span style="color: #010001;">This type consists of a whole and a fractional setting, allowing your application to create pseudo-floating point numbers that the DTWAIN library can process.  </span></p>
<p>&nbsp;</p>
<p><span style="color: #010001;">Here is a small 'C' example of using these functions (note that this example never needs to be done using 'C', since 'C' handles DTWAIN_FLOAT values with no issues. &nbsp;The example is only for illustrative purposes):</span></p>
<p>&nbsp;</p>
<p><span style="font-size: 9pt;"> &nbsp; #include &quot;dtwain.h&quot;</span></p>
<p> &nbsp;#include &lt;stdio.h&gt;</p>
<p>&nbsp;</p>
<p><span style="font-size: 9pt;"> &nbsp; void Test()</span></p>
<p><span style="font-size: 9pt;"> &nbsp; {</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; LONG TwainSource;</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; <a href="http://www.helpandmanual.com/order.html" class="topiclink">DTWAIN_SysInitialize</a>( );</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; TwainSource = <a href="dtwain_selectsource.htm" class="topiclink">DTWAIN_SelectSource</a>( );</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; if ( TwainSource )</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; {</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LONG i, Whole, Frac, numValues;</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; double dVal;</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DTWAIN_ARRAY floatArray, fixedPtArray;</span></p>
<p>&nbsp;</p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* get the resolution values that are used by the Source */</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="dtwain_enumresolutionvalues.htm" class="topiclink">DTWAIN_EnumResolutionValues</a>( TwainSource, &amp;floatArray, TRUE );</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; numValues = <a href="dtwain_arraygetcount.htm" class="topiclink">DTWAIN_ArrayGetCount</a>( floatrrray );</span></p>
<p>&nbsp;</p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* Convert to fixed point DTWAIN_ARRAY */</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fixedPtArray = <a href="dtwain_arrayconvertfloattofix3.htm" class="topiclink">DTWAIN_ArrayConvertFloatToFix32</a>( floatArray );</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for (i = 0; i &lt; numValues; ++i )</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/* Whole and Frac contain the values in the array */</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <a href="dtwain_arrayfix32getat.htm" class="topiclink">DTWAIN_ArrayFix32GetAt</a>( fixedPtArrray, i, &amp;Whole, &amp;Frac );</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; % &nbsp; d &nbsp; &nbsp; &nbsp;printf( &quot;%d.%d\n&quot;, Whole, Frac );</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p>
<p>&nbsp;</p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* to test, convert the fixed point array back to a DTWAIN_ARRAYFLOAT array */</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; floatArray = <a href="dtwain_arrayconvertfix32tofloa.htm" class="topiclink">DTWAIN_ArrayConvertFix32ToFloat</a>( fixedPtArray ); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p>
<p>&nbsp;</p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* print out the floating point falues */</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for (i = 0; i &lt; numValues; ++i )</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <a href="dtwain_arraygetatfloat.htm" class="topiclink">DTWAIN_ArrayGetAtFloat</a>( floayArray, i, &amp;dVal );</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;printf( &quot;%lf\n&quot;, dVal );</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp; &nbsp;}</span></p>
<p><span style="font-size: 9pt;"> &nbsp; &nbsp; &nbsp;  <a href="dtwain_sysdestroy.htm" class="topiclink">DTWAIN_SysDestroy</a>( );</span></p>
<p><span style="font-size: 9pt;"> &nbsp;}</span></p>
<p>&nbsp;</p>

</td></tr></table>

</body>
</html>
